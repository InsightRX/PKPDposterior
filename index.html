<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MCMC-based inference based a population PK model and individual
    TDM data.">
<title>MCMC-Based MIPD • PKPDposterior</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="MCMC-Based MIPD">
<meta property="og:description" content="MCMC-based inference based a population PK model and individual
    TDM data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">PKPDposterior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="pkpdposterior">PKPDposterior<a class="anchor" aria-label="anchor" href="#pkpdposterior"></a>
</h1></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This software package provides convenience functions around Stan, Torsten, and PKPDsim. The goal of the package is to make it easier to full-Bayesian inference in the context of model-informed precision dosing.</p>
<p>The software is intended for use in education and research, and is <strong>not intended for clinical use</strong>. By design, this package does not include functionality that directly provides dosing advice.</p>
</div>
<div class="section level2">
<h2 id="installation-and-getting-started">Installation and getting started<a class="anchor" aria-label="anchor" href="#installation-and-getting-started"></a>
</h2>
<p>Install the latest version of PKPDposterior using remotes or devtools:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"InsightRX/PKPDposterior"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"InsightRX/PKPDposterior"</span><span class="op">)</span></code></pre></div>
<p>PKPDposterior depends on Torsten and Stan. If you don’t already have these software working, follow the instructions for installing <a href="https://github.com/metrumresearchgroup/Torsten" class="external-link">Torsten</a>. Then, add the file path to your Stan installation location to your environment variables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>STAN_PATH <span class="op">=</span> <span class="st">"path/to/stan"</span><span class="op">)</span></code></pre></div>
<p>To avoid running the above command every time you restart your R session, consider adding this environment variable to your .Rprofile or other configuration file.</p>
<p>Prepare your R session to use Stan by running the following line of code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/set_cmdstan_path.html" class="external-link">set_cmdstan_path</a></span><span class="op">(</span>
    path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"STAN_PATH"</span><span class="op">)</span>, <span class="st">"cmdstan"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Great! Now you should be all ready to start modeling!</p>
</div>
<div class="section level2">
<h2 id="model-syntax">Model syntax<a class="anchor" aria-label="anchor" href="#model-syntax"></a>
</h2>
<p>For structured analysis in PKPDposterior it is required to write your Stan/Torsten models using standardized syntax. The following variables are recognized, with their approximate equivalent in NONMEM, if available:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Variable name</th>
<th>Meaning</th>
<th>NONMEM equivalent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>dv</code></td>
<td>Vector of observed values</td>
<td>
<code>DV</code> column in input</td>
</tr>
<tr class="even">
<td><code>ipred</code></td>
<td>Vector of predicted values for all event times</td>
<td>
<code>IPRED</code> column in output</td>
</tr>
<tr class="odd">
<td><code>ipred_obs</code></td>
<td>Vector of predicted values for observation records only</td>
<td>
<code>IPRED</code> column in output for records where <code>EVID==0</code>
</td>
</tr>
<tr class="even">
<td><code>ipred_ruv</code></td>
<td>Vector of predicted values for observation records only, with residual variability simulated</td>
<td>
<code>Y</code> in model file, <code>DV</code> in output table</td>
</tr>
<tr class="odd">
<td><code>n_t</code></td>
<td>Number of event records</td>
<td>Number of rows in input dataset</td>
</tr>
<tr class="even">
<td><code>n_cmt</code></td>
<td>Number of compartments</td>
<td></td>
</tr>
<tr class="odd">
<td><code>n_obs</code></td>
<td>Number of observations</td>
<td>Number of rows in input dataset with <code>EVID==0</code>
</td>
</tr>
<tr class="even">
<td><code>i_obs</code></td>
<td>Index of observation records within all event records</td>
<td></td>
</tr>
<tr class="odd">
<td><code>theta</code></td>
<td>Vector of model parameters</td>
<td>
<code>$THETA</code> (although not same data format)</td>
</tr>
<tr class="even">
<td><code>ode</code></td>
<td>Function for the ODE system</td>
<td><code>$ODE</code></td>
</tr>
<tr class="odd">
<td><code>A</code></td>
<td>Vector of amounts in compartments</td>
<td>
<code>A</code> in model file</td>
</tr>
<tr class="even">
<td><code>dAdt</code></td>
<td>Vector of gradients for ODE system</td>
<td>
<code>DADT</code> in model file</td>
</tr>
<tr class="odd">
<td><code>prior_&lt;parameter&gt;</code></td>
<td>Samples of prior parameter distribution</td>
<td></td>
</tr>
</tbody>
</table>
<p>For models with more than one observation type, such as PK-PD models, or a parent-metabolite model, the variables related to observations (i.e. in the first 8 rows) should be appended with a tag for the respective observation type, e.g. <code>dv_pk</code> and <code>dv_pd</code>, or <code>dv_parent</code> and <code>dv_metab</code>, etc. See the neutropenia model for an example.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>We welcome input from the community:</p>
<ul>
<li><p>If you think you have encountered a bug, please <a href="https://github.com/InsightRX/PKPDposterior/issues" class="external-link">submit an issue</a> on the GitHub page. Please include a reproducible example of the unexpected behavior.</p></li>
<li><p>Please <a href="https://github.com/InsightRX/PKPDposterior/pulls" class="external-link">open a pull request</a> if you have a fix or updates that would improve the package. If you’re not sure if your proposed changes are useful or within scope of the package, feel free to contact one of the authors of this package.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>The functionality in this R package is provided “as is”. While its authors adhere to software development best practices, the software may still contain unintended errors.</p>
<p>InsightRX Inc. and the authors of this package can not be held liable for any damages resulting from any use of this software. By the use of this software package, the user waives all warranties, expressed or implied, including any warranties to the accuracy, quality or suitability of InsightRX for any particular purpose, either medical or non-medical.</p>
<div align="right"><p>© <img src="reference/figures/insightrx_logo_color.png" alt="InsightRX logo" width="120"></p></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing PKPDposterior</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ron Keizer <br><small class="roles"> Author, maintainer </small>  </li>
<li>Jasmine Hughes <br><small class="roles"> Author </small>  </li>
<li>Dominic Tong <br><small class="roles"> Author </small>  </li>
<li>Kara Woo <br><small class="roles"> Author </small>  </li>
<li>InsightRX <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ron Keizer, Jasmine Hughes, Dominic Tong, Kara Woo, InsightRX.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
